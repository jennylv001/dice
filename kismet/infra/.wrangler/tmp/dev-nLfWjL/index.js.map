{
  "version": 3,
  "sources": ["../bundle-hhW1rt/checked-fetch.js", "../../../../shared/src/crypto.ts", "../../../../worker/src/utils.ts", "../../../../worker/src/kv.ts", "../../../../shared/src/stimuli.ts", "../../../../shared/src/constants.ts", "../../../../worker/src/verify.ts", "../../../../worker/src/router.ts", "../../../../worker/src/do_room.ts", "../../../../worker/src/index.ts", "../../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-hhW1rt/middleware-insertion-facade.js", "../../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-hhW1rt/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/macbookpro/Desktop/PP/kismet/infra/.wrangler/tmp/dev-nLfWjL",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "export async function sha256(data: ArrayBuffer | Uint8Array): Promise<ArrayBuffer> {\n  const buf = data instanceof Uint8Array ? data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength) : data;\n  return crypto.subtle.digest(\"SHA-256\", buf as ArrayBuffer);\n}\nexport function b64url(bytes: Uint8Array): string {\n  const b64 = btoa(String.fromCharCode(...bytes));\n  return b64.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/g, \"\");\n}\nexport function fromHex(hex: string): Uint8Array {\n  const clean = hex.replace(/[^a-fA-F0-9]/g, \"\");\n  const out = new Uint8Array(clean.length / 2);\n  for (let i = 0; i < out.length; i++) out[i] = parseInt(clean.slice(i * 2, i * 2 + 2), 16);\n  return out;\n}\nexport function toHex(bytes: Uint8Array): string {\n  return [...bytes].map(b => b.toString(16).padStart(2, \"0\")).join(\"\");\n}\nexport function concatBytes(...arrs: Uint8Array[]): Uint8Array {\n  const total = arrs.reduce((n, a) => n + a.length, 0);\n  const out = new Uint8Array(total);\n  let o = 0;\n  for (const a of arrs) { out.set(a, o); o += a.length; }\n  return out;\n}\n", "import { b64url } from \"../../shared/src/crypto.js\";\nexport function okJson(obj: unknown, init: ResponseInit = {}) {\n  return new Response(JSON.stringify(obj), { headers: { \"content-type\": \"application/json\" }, ...init });\n}\nexport function bad(reason: string, code = 400) { return okJson({ error: reason }, { status: code }); }\nexport function toB64u(buf: ArrayBuffer): string { return b64url(new Uint8Array(buf)); }\n", "type KVNamespace = {\n  put(key: string, value: string, options?: { expirationTtl?: number }): Promise<void>;\n  get(key: string): Promise<string | null>;\n};\ntype DurableObjectId = unknown;\ntype DurableObjectStub = { fetch(request: Request): Promise<Response> };\ntype DurableObjectNamespace = { idFromName(name: string): DurableObjectId; get(id: DurableObjectId): DurableObjectStub };\nexport type Env = {\n  KISMET_KV: KVNamespace;\n  ROOM_DO: DurableObjectNamespace;\n  PROTOCOL_VERSION: string;\n  STRICT_MODE?: string;\n};\nexport async function kvPutTTL(kv: KVNamespace, key: string, value: any, ttlSec = 600) {\n  await kv.put(key, JSON.stringify(value), { expirationTtl: ttlSec });\n}\nexport async function kvGet<T>(kv: KVNamespace, key: string): Promise<T | null> {\n  const v = await kv.get(key); return v ? JSON.parse(v) as T : null;\n}\nexport async function kvIncr(kv: KVNamespace, key: string, by = 1) {\n  const cur = Number((await kv.get(key)) || \"0\"); await kv.put(key, String(cur + by));\n}\n", "export type StimSchedule = {\n  durMs: number;\n  luma: number[];\n  barcode: number[];\n  haptics: number[];\n  chirps: { tMs: number; freq: number }[];\n};\nexport function xorshift128(seed: Uint8Array): () => number {\n  let x = (seed[0] << 24) | (seed[1] << 16) | (seed[2] << 8) | seed[3];\n  let y = (seed[4] << 24) | (seed[5] << 16) | (seed[6] << 8) | seed[7];\n  let z = (seed[8] << 24) | (seed[9] << 16) | (seed[10] << 8) | seed[11];\n  let w = (seed[12] << 24) | (seed[13] << 16) | (seed[14] << 8) | seed[15];\n  return () => {\n    const t = x ^ (x << 11);\n    x = y; y = z; z = w;\n    w = (w ^ (w >>> 19) ^ (t ^ (t >>> 8))) >>> 0;\n    return (w & 0xffffffff) / 0x100000000;\n  };\n}\nexport function buildSchedule(nonceStim: Uint8Array, durMs = 2000): StimSchedule {\n  const rand = xorshift128(nonceStim);\n  const frames = Math.round((durMs / 1000) * 60);\n  const luma: number[] = [];\n  const a1 = 0.015 + rand() * 0.01, a2 = 0.01 + rand() * 0.01, a3 = 0.005 + rand() * 0.005;\n  const p1 = rand() * Math.PI * 2, p2 = rand() * Math.PI * 2, p3 = rand() * Math.PI * 2;\n  for (let i = 0; i < frames; i++) {\n    const t = i / 60;\n    const v = 1 + a1 * Math.sin(2 * Math.PI * 1.3 * t + p1) + a2 * Math.sin(2 * Math.PI * 2.1 * t + p2) + a3 * Math.sin(2 * Math.PI * 0.7 * t + p3);\n    luma.push(Math.max(0.97, Math.min(1.03, v)));\n  }\n  const barcode = Array(frames).fill(0);\n  for (let k = 0; k < 6; k++) barcode[Math.min(frames - 1, Math.floor(rand() * (frames - 6)) + k)] = 1;\n  const haptics = [rand(), rand(), rand()].map(r => Math.floor(300 + r * 1200));\n  const freqs = [17300, 18300, 19300];\n  const nC = 2 + Math.floor(rand() * 2);\n  const chirps = Array.from({ length: nC }, () => ({ tMs: Math.floor(250 + rand() * 1400), freq: freqs[Math.floor(rand() * freqs.length)] }));\n  return { durMs, luma, barcode, haptics, chirps };\n}\n", "export const PROTOCOL_VERSION = 1 as const;\nexport const FRAME_LUMA_SIZE = { w: 64, h: 36 } as const;\n\nexport const LIVENESS_THRESHOLDS = {\n  rLumaMin: 0.82,\n  barcodeMaxErr: 0.25,\n  hapticImuMsMax: 10,\n  chirpSnrMinDb: 6,\n  vioImuDevMax: 0.35,\n  minTumble: 2,\n  settleStableMs: 200\n} as const;\n\nexport const AUDIO_CHIRP_FREQS = [17300, 18300, 19300] as const;\nexport const CHIRP_DURATION_MS = 35;\nexport const MAX_DICE = 5;\n\nexport const INTEGRITY_WEIGHTS = {\n  rLuma: 0.3,\n  barcode: 0.15,\n  haptic: 0.2,\n  chirp: 0.2,\n  vioImu: 0.15\n} as const;\n\nexport const UI_META_SEED_BYTES = 8;\n", "import { LIVENESS_THRESHOLDS } from \"../../shared/src/constants.js\";\nimport type { Proof } from \"./types.js\";\nimport { sha256, b64url } from \"../../shared/src/crypto.js\";\nimport { buildSchedule } from \"../../shared/src/stimuli.js\";\n\nexport async function verifyProof(proof: Proof, nonces_b64u: { session: string; stim: string }, strictMode: boolean) {\n  if (proof.version !== 1) return { ok: false, reason: \"version_mismatch\" } as const;\n  if (proof.nonces.session !== nonces_b64u.session || proof.nonces.stim !== nonces_b64u.stim)\n    return { ok: false, reason: \"nonce_mismatch\" } as const;\n\n  const L = LIVENESS_THRESHOLDS, lv = proof.liveness, ch = proof.channels;\n  const passed: Record<\"luma\"|\"barcode\"|\"haptic\"|\"chirp\"|\"vio\", boolean> = {\n    luma: lv.r_luma >= L.rLumaMin,\n    barcode: lv.barcode_err <= L.barcodeMaxErr,\n    haptic: ch.haptics && ch.imu ? lv.haptic_imu_ms <= L.hapticImuMsMax : true,\n    chirp: ch.audio ? lv.chirp_snr >= L.chirpSnrMinDb : true,\n    vio: ch.video && ch.imu ? lv.vio_imu_dev <= L.vioImuDevMax : true\n  };\n  if (!(passed.luma && passed.barcode)) return { ok: false, reason: \"visual_liveness\" } as const;\n\n  if (strictMode) {\n    const count = [passed.haptic, passed.chirp, passed.vio].filter(Boolean).length;\n    if (count < 2) return { ok: false, reason: \"insufficient_channels\" } as const;\n  }\n\n  for (const d of proof.dice) if (d.tumble_count < L.minTumble) return { ok: false, reason: \"tumble_low\" } as const;\n\n  const schedule = buildSchedule(b64uToBytes(nonces_b64u.stim));\n  if (proof.audit?.frames?.length) {\n    let hit = 0;\n    for (const f of proof.audit.frames) {\n      const idx = Math.round((f.t_ms / schedule.durMs) * (schedule.barcode.length - 1));\n      if (schedule.barcode[idx]) hit++;\n    }\n    if (hit < 2) return { ok: false, reason: \"barcode_audit_fail\" } as const;\n  }\n\n  const digestSource = JSON.stringify(slim(proof));\n  const digest = await sha256(new TextEncoder().encode(digestSource));\n  const key = await crypto.subtle.importKey(\"jwk\", proof.webauthn.publicKeyJwk, { name: \"ECDSA\", namedCurve: \"P-256\" }, false, [\"verify\"]);\n  const sig = b64uToBytes(proof.webauthn.signatureB64u);\n  const verified = await crypto.subtle.verify({ name: \"ECDSA\", hash: \"SHA-256\" }, key, sig, digest);\n  if (!verified) return { ok: false, reason: \"sig_invalid\" } as const;\n\n  for (const r of [proof.stream_roots.video, proof.stream_roots.imu, proof.stream_roots.audio])\n    if (b64uToBytes(r).length !== 32) return { ok: false, reason: \"root_size\" } as const;\n\n  const score = integrityScore(proof.liveness, proof.dice.map(d => d.confidence));\n  return { ok: true, score } as const;\n}\n\nfunction integrityScore(lv: Proof[\"liveness\"], confidences: number[]) {\n  const r = norm((lv.r_luma - 0.7) / 0.3);\n  const b = norm((0.4 - lv.barcode_err) / 0.4);\n  const h = norm((10 - lv.haptic_imu_ms) / 10);\n  const c = norm((lv.chirp_snr - 4) / 12);\n  const v = norm((0.5 - lv.vio_imu_dev) / 0.5);\n  const overall = 0.3*r + 0.15*b + 0.2*h + 0.2*c + 0.15*v;\n  return { overall, per_die: confidences.map(c => norm(c)) };\n}\nconst norm = (x: number) => Math.max(0, Math.min(1, x));\n\nfunction b64uToBytes(s: string) {\n  let txt = s.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  const pad = txt.length % 4 ? 4 - (txt.length % 4) : 0;\n  txt += \"=\".repeat(pad);\n  const b = atob(txt);\n  const out = new Uint8Array(b.length);\n  for (let i = 0; i < b.length; i++) out[i] = b.charCodeAt(i);\n  return out;\n}\nfunction slim(p: Proof) { const { audit, ...rest } = p; return rest; }\n", "import { okJson, bad } from \"./utils.js\";\nimport type { Env } from \"./kv.js\";\nimport { kvGet, kvPutTTL, kvIncr } from \"./kv.js\";\nimport { buildSchedule } from \"../../shared/src/stimuli.js\";\nimport { verifyProof } from \"./verify.js\";\nimport type { Proof, RPv1 } from \"./types.js\";\nimport { sha256, b64url } from \"../../shared/src/crypto.js\";\n\nexport async function handleApi(req: Request, env: Env) {\n  const url = new URL(req.url);\n\n  if (url.pathname === \"/api/start-roll\" && req.method === \"POST\") {\n  const { roomId, userId } = (await req.json()) as { roomId: string; userId: string };\n    if (!roomId || !userId) return bad(\"missing_params\");\n    const nonce_session = crypto.getRandomValues(new Uint8Array(16));\n    const nonce_stim = crypto.getRandomValues(new Uint8Array(16));\n    const nonces_b64u = { session: b64url(nonce_session), stim: b64url(nonce_stim) };\n    const round_id = b64url(new Uint8Array(await sha256(nonce_session) as ArrayBuffer));\n    await kvPutTTL(env.KISMET_KV, `nonces:${roomId}:${round_id}:${userId}`, nonces_b64u, 120);\n    const schedule = buildSchedule(nonce_stim);\n    return okJson({ nonces_b64u, schedule, round_id });\n  }\n\n  if (url.pathname === \"/api/submit-roll\" && req.method === \"POST\") {\n    const proof = (await req.json()) as Proof;\n    const roomId = url.searchParams.get(\"roomId\") || \"room\";\n    const userId = url.searchParams.get(\"userId\") || \"u\";\n    const round_id = await deriveRoundId(proof.nonces.session);\n    const nonces = await kvGet<{ session: string; stim: string }>(env.KISMET_KV, `nonces:${roomId}:${round_id}:${userId}`);\n    if (!nonces) return bad(\"nonces_missing_or_expired\");\n\n    const strict = (env.STRICT_MODE || \"true\").toLowerCase() === \"true\";\n    const res = await verifyProof(proof, nonces, strict);\n    if (!(\"ok\" in res) || !res.ok) return okJson({ ok: false, reason: (res as any).reason }, { status: 400 });\n\n    const digestBuffer = await sha256(new TextEncoder().encode(JSON.stringify(proof)));\n    const rp: RPv1 = {\n      match_id: roomId,\n      round_id,\n      roller_user_id: userId,\n      opponent_user_id: \"\",\n      timestamp_server: Date.now(),\n      dice_values: proof.dice.map(d => d.value),\n      proof_digest_b64u: b64url(new Uint8Array(digestBuffer as ArrayBuffer)),\n      device_sig_b64u: proof.webauthn.signatureB64u,\n      integrity_scores: res.score,\n      ui_meta: { fx_seed_b64u: b64url(crypto.getRandomValues(new Uint8Array(8))) }\n    };\n\n    await kvIncr(env.KISMET_KV, `rank:${userId}:xp`, Math.round(10 + res.score.overall * 20));\n\n    const id = env.ROOM_DO.idFromName(roomId);\n    const stub = env.ROOM_DO.get(id);\n    const lastFrame = proof.audit.frames[proof.audit.frames.length - 1];\n    await stub.fetch(new Request(new URL(\"/do/thumb\", req.url), { method: \"POST\", body: JSON.stringify({ userId, thumb: lastFrame }) }));\n    await stub.fetch(new Request(new URL(\"/do/submit\", req.url), { method: \"POST\", body: JSON.stringify({ userId, rp }) }));\n\n    return okJson({ ok: true });\n  }\n\n  if (url.pathname.startsWith(\"/api/room/\") && req.headers.get(\"Upgrade\") === \"websocket\") {\n    const roomId = url.pathname.split(\"/\").pop()!;\n    const id = env.ROOM_DO.idFromName(roomId);\n    const stub = env.ROOM_DO.get(id);\n    return stub.fetch(req);\n  }\n\n  if (url.pathname === \"/api/join\" && req.method === \"POST\") {\n  const { roomId } = (await req.json()) as { roomId: string };\n    if (!roomId) return bad(\"missing_room\");\n    const id = env.ROOM_DO.idFromName(roomId);\n    const stub = env.ROOM_DO.get(id);\n    return stub.fetch(new Request(new URL(\"/do/new\", req.url), { method: \"POST\" }));\n  }\n\n  return new Response(\"not found\", { status: 404 });\n}\n\nasync function deriveRoundId(nonceSessionB64u: string) {\n  const digest = await sha256(b64uToBytes(nonceSessionB64u));\n  return b64url(new Uint8Array(digest as ArrayBuffer));\n}\nfunction b64uToBytes(s: string) {\n  let txt = s.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  const pad = txt.length % 4 ? 4 - (txt.length % 4) : 0;\n  txt += \"=\".repeat(pad);\n  const b = atob(txt);\n  const out = new Uint8Array(b.length);\n  for (let i = 0; i < b.length; i++) out[i] = b.charCodeAt(i);\n  return out;\n}\n", "import type { Env } from \"./kv.js\";\nimport type { RPv1 } from \"./types.js\";\nimport type { AuditFrame, WSFromClient, WSFromServer } from \"../../shared/src/types.js\";\n\ntype DurableObjectState = { waitUntil(promise: Promise<any>): void };\ntype DurableObjectId = unknown;\ntype DurableObjectStub = { fetch(request: Request): Promise<Response> };\n\ndeclare const WebSocketPair: { new (): { 0: WebSocket; 1: WebSocket } };\n\ntype Client = { ws: WebSocket; userId: string; spectator: boolean; rtcWanted: boolean };\n\ntype DurableObjectNamespace = Env[\"ROOM_DO\"];\n\nexport class RoomDO {\n  state: DurableObjectState;\n  env: Env;\n  clients: Map<string, Client>;\n  order: string[];\n  currentIdx: number;\n  lastRP?: RPv1;\n\n  constructor(state: DurableObjectState, env: Env) {\n    this.state = state;\n    this.env = env;\n    this.clients = new Map();\n    this.order = [];\n    this.currentIdx = 0;\n  }\n\n  async fetch(req: Request) {\n    const url = new URL(req.url);\n    if (url.pathname.endsWith(\"/do/new\") && req.method === \"POST\") return new Response(\"ok\", { status: 200 });\n\n    if (url.pathname.endsWith(\"/do/thumb\") && req.method === \"POST\") {\n      const { userId, thumb } = (await req.json()) as { userId: string; thumb: AuditFrame };\n      this.broadcastExcept(userId, JSON.stringify({ t: \"opp_thumb\", p: thumb } as WSFromServer));\n      return new Response(\"ok\");\n    }\n\n    if (url.pathname.endsWith(\"/do/submit\") && req.method === \"POST\") {\n      const { userId, rp } = (await req.json()) as { userId: string; rp: RPv1 };\n      this.lastRP = rp;\n      this.broadcastExcept(userId, JSON.stringify({ t: \"opp_result\", p: rp } as WSFromServer));\n      this.advanceTurn();\n      return new Response(\"ok\");\n    }\n\n    if (req.headers.get(\"Upgrade\") === \"websocket\") {\n      const pair = new WebSocketPair();\n      const [client, server] = Object.values(pair);\n      this.handleSocket(server, url);\n  return new Response(null, { status: 101, webSocket: client } as any);\n    }\n    return new Response(\"not found\", { status: 404 });\n  }\n\n  handleSocket(ws: WebSocket, url: URL) {\n    const roomId = url.pathname.split(\"/\").pop()!;\n  (ws as any).accept();\n    let userId = \"anon-\" + Math.random().toString(36).slice(2);\n    let spectator = false;\n\n    const send = (m: WSFromServer) => ws.send(JSON.stringify(m));\n\n    ws.addEventListener(\"message\", (ev) => {\n      try {\n        const msg = JSON.parse(ev.data as string) as WSFromClient;\n        if (msg.t === \"join\") {\n          userId = msg.p.userId;\n          spectator = !!msg.p.spectator;\n          this.clients.set(userId, { ws, userId, spectator, rtcWanted: false });\n          if (!spectator && !this.order.includes(userId)) this.order.push(userId);\n          send({ t: \"joined\", p: { roomId, you: userId, opp: this.order.find(u => u !== userId), spectator } });\n          this.notifyTurn();\n        } else if (msg.t === \"rtc_want\") {\n          const c = this.clients.get(userId); if (c) c.rtcWanted = !!msg.p.enable;\n          this.broadcastExcept(userId, JSON.stringify({ t: \"rtc_want\", p: { from: userId, enable: !!msg.p.enable } } as WSFromServer));\n        } else if (msg.t === \"rtc_offer\") {\n          this.broadcastExcept(userId, JSON.stringify({ t: \"rtc_offer\", p: { from: userId, sdp: msg.p.sdp } } as WSFromServer));\n        } else if (msg.t === \"rtc_answer\") {\n          this.broadcastExcept(userId, JSON.stringify({ t: \"rtc_answer\", p: { from: userId, sdp: msg.p.sdp } } as WSFromServer));\n        } else if (msg.t === \"rtc_ice\") {\n          this.broadcastExcept(userId, JSON.stringify({ t: \"rtc_ice\", p: { from: userId, candidate: msg.p.candidate } } as WSFromServer));\n        }\n      } catch {\n        /* ignore malformed */\n      }\n    });\n\n    ws.addEventListener(\"close\", () => {\n      this.clients.delete(userId);\n      this.order = this.order.filter(u => u !== userId);\n      if (this.currentIdx >= this.order.length) this.currentIdx = 0;\n      this.notifyTurn();\n    });\n  }\n\n  notifyTurn() {\n    if (this.order.length === 0) return;\n    const current = this.order[this.currentIdx];\n    for (const [uid, c] of this.clients) {\n      if (uid === current && !c.spectator) c.ws.send(JSON.stringify({ t: \"your_turn\", p: { round_id: crypto.randomUUID() } } satisfies WSFromServer));\n    }\n  }\n\n  advanceTurn() {\n    if (this.order.length === 0) return;\n    this.currentIdx = (this.currentIdx + 1) % this.order.length;\n    this.notifyTurn();\n  }\n\n  broadcastExcept(userId: string, msg: string) {\n    for (const [uid, c] of this.clients) if (uid !== userId) c.ws.send(msg);\n  }\n}\n", "import { handleApi } from \"./router.js\";\nimport { RoomDO } from \"./do_room.js\";\nimport type { Env } from \"./kv.js\";\n\ntype ExecutionContext = { waitUntil(promise: Promise<any>): void };\ntype ExportedHandler<TEnv> = { fetch: (req: Request, env: TEnv, ctx: ExecutionContext) => Promise<Response> | Response };\n\nconst handler: ExportedHandler<Env> = {\n  async fetch(req, env, ctx) {\n    const url = new URL(req.url);\n    if (url.pathname.startsWith(\"/api/\")) {\n      return handleApi(req, env as Env);\n    }\n    return new Response(\"Kismet Worker\", { status: 200 });\n  }\n};\n\nexport default handler;\n\nexport { RoomDO };\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/macbookpro/Desktop/PP/kismet/worker/src/index.ts\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/macbookpro/Desktop/PP/kismet/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/macbookpro/Desktop/PP/kismet/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/macbookpro/Desktop/PP/kismet/worker/src/index.ts\";\n\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/macbookpro/Desktop/PP/kismet/infra/.wrangler/tmp/bundle-hhW1rt/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/macbookpro/Desktop/PP/kismet/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/macbookpro/Desktop/PP/kismet/infra/.wrangler/tmp/bundle-hhW1rt/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/macbookpro/Desktop/PP/kismet/infra/.wrangler/tmp/bundle-hhW1rt/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["c", "b64uToBytes"]
}
